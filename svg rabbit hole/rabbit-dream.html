<!DOCTYPE html>
<html><head><meta charset="utf-8"/><title>rabbit dream — falling through</title>
<style>html,body{margin:0;height:100%;background:#000;overflow:hidden}canvas{display:block;width:100vw;height:100vh}</style>
</head><body>
<canvas id="c"></canvas>
<script>
const canvas=document.getElementById('c'); const gl=canvas.getContext('webgl');
function resize(){const dpr=Math.max(1,devicePixelRatio||1);canvas.width=Math.floor(innerWidth*dpr);canvas.height=Math.floor(innerHeight*dpr);gl.viewport(0,0,canvas.width,canvas.height);}
addEventListener('resize',resize); resize();
const vs=`attribute vec2 position; void main(){ gl_Position = vec4(position,0.0,1.0); }`;
const fs=`
precision highp float;
uniform float time;
uniform vec2 resolution;

// complex multiply
vec2 cmul(vec2 a, vec2 b){ return vec2(a.x*b.x - a.y*b.y, a.x*b.y + a.y*b.x); }

// domain-warped fractal — the "dream" texture
float dreamFractal(vec2 p, float t){
  vec2 z = p;
  float glow = 0.0;
  for(int i = 0; i < 12; i++){
    // rotate z in complex plane, breathing
    float breath = 0.95 + 0.08 * sin(t * 0.4 + float(i) * 0.5);
    z = abs(z) / dot(z,z) - vec2(breath, 0.62 + 0.12*sin(t*0.3));
    z = cmul(z, vec2(cos(t*0.07+float(i)*0.1), sin(t*0.07+float(i)*0.1)));
    glow += exp(-3.5 * dot(z,z));
  }
  return glow / 12.0;
}

void main(){
  vec2 uv = (gl_FragCoord.xy - 0.5*resolution.xy) / resolution.y;
  float t = time;
  float r = length(uv);
  float a = atan(uv.y, uv.x);

  // slow descent — zoom into the fractal over time
  float zoom = 1.8 + 0.4 * sin(t * 0.15);
  vec2 p = uv * zoom;

  // domain warp: twist space as if falling down a tunnel
  float twist = 0.3 * sin(t * 0.2) + r * 1.5;
  p = vec2(
    p.x * cos(twist) - p.y * sin(twist),
    p.x * sin(twist) + p.y * cos(twist)
  );

  // drift through fractal space
  p += vec2(0.3 * sin(t * 0.13), 0.3 * cos(t * 0.11));

  float f = dreamFractal(p, t);

  // second layer — different scale, creates depth
  vec2 p2 = uv * (zoom * 1.6) + vec2(sin(t*0.09)*0.5, cos(t*0.07)*0.5);
  float twist2 = -0.2 * sin(t * 0.17) + r * 0.8;
  p2 = vec2(
    p2.x * cos(twist2) - p2.y * sin(twist2),
    p2.x * sin(twist2) + p2.y * cos(twist2)
  );
  float f2 = dreamFractal(p2, t * 0.7 + 10.0);

  // blend layers
  float val = f * 0.65 + f2 * 0.35;

  // contrast curve — make it more dramatic
  val = smoothstep(0.05, 0.7, val);

  // subtle pulsating halos at certain radii (falling rings)
  float rings = 0.0;
  for(int i = 0; i < 4; i++){
    float fi = float(i);
    float ringR = fract(fi * 0.25 - t * 0.08);
    ringR = ringR * 0.9 + 0.05;
    float ringW = 0.008 + 0.004 * sin(t + fi);
    rings += smoothstep(ringW, 0.0, abs(r - ringR)) * (1.0 - ringR) * 0.3;
  }

  val += rings;

  // vignette — darkness at edges
  float vig = smoothstep(1.1, 0.3, r);
  val *= vig;

  vec3 col = vec3(val);

  // the rabbit hole — absolute black center
  col = mix(col, vec3(0.0), smoothstep(0.0, 0.012, 0.09 - r));

  gl_FragColor = vec4(col, 1.0);
}`;

function sh(src,t){const h=gl.createShader(t);gl.shaderSource(h,src);gl.compileShader(h);if(!gl.getShaderParameter(h,gl.COMPILE_STATUS))console.error(gl.getShaderInfoLog(h));return h;}
const prog=gl.createProgram(); gl.attachShader(prog,sh(vs,gl.VERTEX_SHADER)); gl.attachShader(prog,sh(fs,gl.FRAGMENT_SHADER)); gl.linkProgram(prog);
const buf=gl.createBuffer(); gl.bindBuffer(gl.ARRAY_BUFFER,buf); gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([-1,-1, 1,-1, -1,1, 1,1]),gl.STATIC_DRAW);
const loc=gl.getAttribLocation(prog,'position'); gl.enableVertexAttribArray(loc); gl.vertexAttribPointer(loc,2,gl.FLOAT,false,0,0);
const uT=gl.getUniformLocation(prog,'time'), uR=gl.getUniformLocation(prog,'resolution');
function render(t){resize(); gl.useProgram(prog); gl.uniform1f(uT,t*0.001); gl.uniform2f(uR,canvas.width,canvas.height); gl.drawArrays(gl.TRIANGLE_STRIP,0,4); requestAnimationFrame(render);}
requestAnimationFrame(render);
document.addEventListener('dblclick',()=>{ if(!document.fullscreenElement) document.documentElement.requestFullscreen(); else document.exitFullscreen&&document.exitFullscreen(); });
</script>
</body></html>
